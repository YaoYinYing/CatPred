/home/ubuntu/miniconda3/envs/catpred/lib/python3.12/site-packages/rotary_embedding_torch/rotary_embedding_torch.py:35: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/home/ubuntu/miniconda3/envs/catpred/lib/python3.12/site-packages/rotary_embedding_torch/rotary_embedding_torch.py:268: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
Command line
python train.py --protein_records_path ./CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_pdbrecords.json --data_path ./CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_train.csv --dataset_type regression --separate_test_path ./CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_test.csv --separate_val_path ./CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_val.csv --smiles_columns substrate_smiles --target_columns log10kcat_max --extra_metrics mae mse r2 --ensemble_size 10 --seq_embed_dim 36 --seq_self_attn_nheads 6 --loss_function mve --batch_size 32 --save_dir ./pretrained/reproduce_checkpoints//kcat_dlkcat/seed0 --epochs 30
Args
{'activation': 'ReLU',
 'add_esm_feats': False,
 'add_pretrained_egnn_feats': False,
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 32,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 10,
 'epochs': 30,
 'esm_feat_size': 1280,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['mae', 'mse', 'r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'gvp_edge_hidden_dims': [100, 30],
 'gvp_node_hidden_dims': [200, 100],
 'gvp_num_layers': 3,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mve',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'mae', 'mse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pretrained_egnn_feats_path': '',
 'protein_mlp_dropout': 0.0,
 'protein_mlp_hidden_size': 600,
 'protein_mlp_num_layers': 2,
 'protein_mlp_output_size': 300,
 'protein_records_path': './CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_pdbrecords.json',
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'reaction_substrate': False,
 'resume_experiment': False,
 'save_dir': './pretrained/reproduce_checkpoints//kcat_dlkcat/seed0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './CatPred-DB/external_data/Kcat_combination_0918_wildtype_mutant_val.csv',
 'separate_val_phase_features_path': None,
 'seq_embed_dim': 36,
 'seq_self_attn_nheads': 6,
 'sequence_max_length': 2048,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'skip_attentive_pooling': False,
 'skip_gvp': False,
 'skip_protein': False,
 'skip_substrate': False,
 'smiles_columns': ['substrate_smiles'],
 'smoke_test': False,
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['log10kcat_max'],
 'target_weights': None,
 'task_names': ['log10kcat_max'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'unfreeze_all': False,
 'use_entransformer': False,
 'use_esm_feats_en_transformer': False,
 'use_esm_feats_gvp': False,
 'use_input_features': False,
 'use_resnet': False,
 'use_transformer': False,
 'val_fold_index': None,
 'vocabulary_path': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
0it [00:00, ?it/s]/home/ubuntu/mychemprop/CatPred/catpred/data/cache_utils.py:95: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(str(entry_path))
1it [00:00,  5.40it/s]14it [00:00, 59.43it/s]44it [00:00, 151.44it/s]77it [00:00, 209.39it/s]105it [00:00, 229.57it/s]135it [00:00, 249.68it/s]167it [00:00, 267.83it/s]195it [00:00, 258.56it/s]222it [00:01, 246.58it/s]248it [00:01, 245.67it/s]282it [00:01, 269.10it/s]313it [00:01, 280.47it/s]353it [00:01, 313.48it/s]392it [00:01, 335.56it/s]428it [00:01, 341.21it/s]466it [00:01, 351.07it/s]502it [00:01, 351.41it/s]538it [00:01, 336.14it/s]572it [00:02, 306.10it/s]604it [00:02, 306.68it/s]637it [00:02, 312.31it/s]673it [00:02, 324.00it/s]706it [00:02, 323.16it/s]743it [00:02, 334.82it/s]779it [00:02, 341.84it/s]814it [00:02, 330.01it/s]848it [00:02, 324.28it/s]883it [00:03, 331.32it/s]917it [00:03, 325.65it/s]950it [00:03, 310.83it/s]982it [00:03, 311.86it/s]1014it [00:03, 312.93it/s]1052it [00:03, 331.65it/s]1092it [00:03, 349.84it/s]1128it [00:03, 351.20it/s]1167it [00:03, 361.02it/s]1204it [00:04, 336.20it/s]1239it [00:04, 315.90it/s]1272it [00:04, 312.93it/s]1304it [00:04, 307.51it/s]1341it [00:04, 324.17it/s]1378it [00:04, 336.91it/s]1419it [00:04, 355.13it/s]1458it [00:04, 362.88it/s]1498it [00:04, 370.68it/s]1536it [00:04, 351.62it/s]1572it [00:05, 333.09it/s]1607it [00:05, 336.10it/s]1645it [00:05, 338.19it/s]1681it [00:05, 340.29it/s]1716it [00:05, 339.72it/s]1754it [00:05, 350.70it/s]1792it [00:05, 357.93it/s]1828it [00:05, 299.09it/s]1861it [00:06, 305.70it/s]1908it [00:06, 347.12it/s]1958it [00:06, 387.60it/s]2013it [00:06, 432.58it/s]2075it [00:06, 485.70it/s]2140it [00:06, 532.94it/s]2211it [00:06, 582.27it/s]2275it [00:06, 596.41it/s]2342it [00:06, 617.11it/s]2405it [00:06, 607.25it/s]2467it [00:07, 574.94it/s]2526it [00:07, 561.10it/s]2584it [00:07, 566.11it/s]2641it [00:07, 564.97it/s]2707it [00:07, 589.98it/s]2777it [00:07, 620.35it/s]2847it [00:07, 643.72it/s]2915it [00:07, 653.63it/s]2981it [00:07, 633.65it/s]3045it [00:08, 497.94it/s]3100it [00:08, 499.71it/s]3162it [00:08, 523.85it/s]3223it [00:08, 546.21it/s]3286it [00:08, 568.51it/s]3348it [00:08, 580.05it/s]3412it [00:08, 596.06it/s]3480it [00:08, 619.76it/s]3545it [00:08, 627.20it/s]3609it [00:09, 577.17it/s]3668it [00:09, 513.58it/s]3732it [00:09, 544.88it/s]3789it [00:09, 547.18it/s]3855it [00:09, 577.59it/s]3927it [00:09, 617.00it/s]4000it [00:09, 647.32it/s]4066it [00:09, 647.01it/s]4133it [00:09, 650.54it/s]4199it [00:09, 636.78it/s]4264it [00:10, 604.33it/s]4325it [00:10, 584.25it/s]4384it [00:10, 462.48it/s]4454it [00:10, 518.60it/s]4521it [00:10, 555.84it/s]4590it [00:10, 590.98it/s]4655it [00:10, 604.57it/s]4721it [00:10, 619.22it/s]4785it [00:11, 591.00it/s]4846it [00:11, 544.90it/s]4910it [00:11, 568.57it/s]4969it [00:11, 569.58it/s]5036it [00:11, 596.93it/s]5098it [00:11, 601.71it/s]5171it [00:11, 637.64it/s]5236it [00:11, 635.41it/s]5302it [00:11, 641.32it/s]5373it [00:11, 660.60it/s]5440it [00:12, 604.32it/s]5502it [00:12, 592.07it/s]5562it [00:12, 591.01it/s]5628it [00:12, 607.30it/s]5697it [00:12, 630.61it/s]5766it [00:12, 645.55it/s]5834it [00:12, 655.34it/s]5904it [00:12, 667.92it/s]5974it [00:12, 675.26it/s]6046it [00:13, 680.96it/s]6115it [00:13, 585.19it/s]6179it [00:13, 598.50it/s]6242it [00:13, 604.28it/s]6308it [00:13, 619.25it/s]6382it [00:13, 650.74it/s]6456it [00:13, 675.71it/s]6526it [00:13, 680.20it/s]6597it [00:13, 686.50it/s]6666it [00:13, 679.86it/s]6735it [00:14, 612.16it/s]6798it [00:14, 606.11it/s]6864it [00:14, 619.14it/s]6934it [00:14, 639.56it/s]7008it [00:14, 667.83it/s]7076it [00:14, 656.85it/s]7148it [00:14, 672.64it/s]7216it [00:14, 660.42it/s]7285it [00:14, 662.19it/s]7352it [00:15, 633.66it/s]7416it [00:15, 596.88it/s]7477it [00:15, 598.19it/s]7541it [00:15, 609.22it/s]7617it [00:15, 650.28it/s]7683it [00:15, 596.45it/s]7754it [00:15, 626.53it/s]7823it [00:15, 644.24it/s]7889it [00:15, 644.25it/s]7956it [00:16, 650.39it/s]8022it [00:16, 575.45it/s]8084it [00:16, 586.38it/s]8145it [00:16, 592.29it/s]8207it [00:16, 598.89it/s]8279it [00:16, 632.79it/s]8349it [00:16, 649.92it/s]8419it [00:16, 662.58it/s]8487it [00:16, 666.37it/s]8554it [00:16, 664.23it/s]8621it [00:17, 646.44it/s]8686it [00:17, 591.61it/s]8755it [00:17, 617.09it/s]8824it [00:17, 630.78it/s]8888it [00:17, 607.79it/s]8959it [00:17, 635.17it/s]9024it [00:17, 638.26it/s]9094it [00:17, 653.79it/s]9163it [00:17, 662.98it/s]9230it [00:18, 662.07it/s]9297it [00:18, 559.36it/s]9365it [00:18, 583.57it/s]9439it [00:18, 623.96it/s]9505it [00:18, 633.32it/s]9577it [00:18, 641.65it/s]9651it [00:18, 667.83it/s]9723it [00:18, 680.11it/s]9795it [00:18, 689.28it/s]9865it [00:19, 679.65it/s]9934it [00:19, 606.71it/s]9997it [00:19, 493.11it/s]10069it [00:19, 545.72it/s]10128it [00:19, 548.63it/s]10192it [00:19, 563.86it/s]10262it [00:19, 598.10it/s]10333it [00:19, 627.38it/s]10402it [00:20, 642.33it/s]10468it [00:20, 640.77it/s]10533it [00:20, 581.44it/s]10600it [00:20, 605.39it/s]10671it [00:20, 632.48it/s]10742it [00:20, 653.58it/s]10817it [00:20, 679.69it/s]10886it [00:20, 644.68it/s]10959it [00:20, 668.11it/s]11027it [00:20, 653.87it/s]11093it [00:21, 645.17it/s]11158it [00:21, 597.71it/s]11219it [00:21, 592.53it/s]11281it [00:21, 599.90it/s]11353it [00:21, 633.59it/s]11425it [00:21, 657.37it/s]11496it [00:21, 672.12it/s]11567it [00:21, 681.68it/s]11638it [00:21, 689.39it/s]11708it [00:22, 667.29it/s]11780it [00:22, 676.80it/s]11848it [00:22, 586.20it/s]11911it [00:22, 594.77it/s]11982it [00:22, 624.66it/s]12054it [00:22, 650.31it/s]12122it [00:22, 656.97it/s]12192it [00:22, 668.72it/s]12267it [00:22, 690.52it/s]12342it [00:22, 706.47it/s]12414it [00:23, 679.09it/s]12483it [00:23, 602.45it/s]12546it [00:23, 554.12it/s]12609it [00:23, 572.25it/s]12689it [00:23, 632.93it/s]12759it [00:23, 650.96it/s]12836it [00:23, 671.87it/s]12910it [00:23, 690.54it/s]12980it [00:24, 672.82it/s]13051it [00:24, 683.43it/s]13120it [00:24, 632.22it/s]13185it [00:24, 610.72it/s]13256it [00:24, 634.49it/s]13335it [00:24, 676.21it/s]13409it [00:24, 694.33it/s]13427it [00:24, 543.80it/s]
  0%|                                                                                  | 0/13427 [00:00<?, ?it/s] 12%|███████▉                                                            | 1566/13427 [00:00<00:00, 13583.62it/s] 89%|███████████████████████████████████████████████████████████▌       | 11929/13427 [00:00<00:00, 43629.72it/s]100%|███████████████████████████████████████████████████████████████████| 13427/13427 [00:00<00:00, 43783.40it/s]
  0%|                                                                                  | 0/13427 [00:00<?, ?it/s]  7%|████▋                                                                 | 904/13427 [00:00<00:01, 9011.60it/s] 20%|█████████████▎                                                      | 2625/13427 [00:00<00:00, 13801.99it/s] 39%|██████████████████████████▎                                         | 5192/13427 [00:00<00:00, 19174.65it/s] 60%|████████████████████████████████████████▊                           | 8059/13427 [00:00<00:00, 22901.96it/s] 86%|█████████████████████████████████████████████████████████▋         | 11558/13427 [00:00<00:00, 27251.85it/s]100%|███████████████████████████████████████████████████████████████████| 13427/13427 [00:00<00:00, 24350.20it/s]
Number of tasks = 1
Fold 0
Splitting data with seed 0
0it [00:00, ?it/s]52it [00:00, 518.47it/s]104it [00:00, 442.86it/s]163it [00:00, 499.31it/s]216it [00:00, 510.53it/s]277it [00:00, 544.52it/s]332it [00:00, 514.51it/s]385it [00:00, 486.67it/s]437it [00:00, 494.29it/s]499it [00:00, 530.67it/s]563it [00:01, 561.05it/s]625it [00:01, 578.31it/s]689it [00:01, 595.47it/s]749it [00:01, 587.59it/s]809it [00:01, 590.49it/s]869it [00:01, 581.34it/s]928it [00:01, 521.23it/s]983it [00:01, 525.14it/s]1051it [00:01, 567.79it/s]1115it [00:02, 588.24it/s]1177it [00:02, 594.10it/s]1242it [00:02, 605.90it/s]1310it [00:02, 623.65it/s]1376it [00:02, 633.67it/s]1441it [00:02, 638.11it/s]1505it [00:02, 588.82it/s]1565it [00:02, 532.23it/s]1626it [00:02, 551.01it/s]1697it [00:03, 594.41it/s]1761it [00:03, 605.89it/s]1823it [00:03, 609.25it/s]1885it [00:03, 607.95it/s]1951it [00:03, 619.65it/s]2014it [00:03, 506.17it/s]2069it [00:03, 403.65it/s]2115it [00:03, 395.33it/s]2159it [00:04, 380.10it/s]2200it [00:04, 379.46it/s]2261it [00:04, 435.41it/s]2320it [00:04, 474.50it/s]2382it [00:04, 512.64it/s]2444it [00:04, 541.04it/s]2502it [00:04, 549.52it/s]2559it [00:04, 485.81it/s]2627it [00:04, 535.48it/s]2692it [00:05, 566.10it/s]2757it [00:05, 588.04it/s]2822it [00:05, 605.18it/s]2888it [00:05, 617.25it/s]2956it [00:05, 635.00it/s]3021it [00:05, 631.33it/s]3085it [00:05, 626.69it/s]3148it [00:05, 562.45it/s]3207it [00:05, 568.51it/s]3272it [00:05, 590.05it/s]3344it [00:06, 624.64it/s]3357it [00:06, 550.33it/s]
  0%|                                                                                   | 0/3357 [00:00<?, ?it/s]100%|████████████████████████████████████████████████████████████████████| 3357/3357 [00:00<00:00, 150736.31it/s]
  0%|                                                                                   | 0/3357 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████| 3357/3357 [00:00<00:00, 40588.87it/s]
0it [00:00, ?it/s]49it [00:00, 488.49it/s]104it [00:00, 524.32it/s]157it [00:00, 510.11it/s]214it [00:00, 532.05it/s]268it [00:00, 524.73it/s]321it [00:00, 496.42it/s]382it [00:00, 529.37it/s]446it [00:00, 562.38it/s]503it [00:00, 562.48it/s]563it [00:01, 573.32it/s]623it [00:01, 580.65it/s]683it [00:01, 584.66it/s]742it [00:01, 573.36it/s]800it [00:01, 533.54it/s]854it [00:01, 485.87it/s]916it [00:01, 521.68it/s]976it [00:01, 539.65it/s]1041it [00:01, 569.53it/s]1104it [00:02, 580.80it/s]1167it [00:02, 594.64it/s]1229it [00:02, 600.86it/s]1290it [00:02, 579.52it/s]1341it [00:02, 552.01it/s]
  0%|                                                                                   | 0/1341 [00:00<?, ?it/s]100%|████████████████████████████████████████████████████████████████████| 1341/1341 [00:00<00:00, 158433.89it/s]
  0%|                                                                                   | 0/1341 [00:00<?, ?it/s]100%|████████████████████████████████████████████████████████████████████| 1341/1341 [00:00<00:00, 124404.18it/s]
Total size = 13,427 | train size = 13,427 | val size = 1,341 | test size = 3,357
Fitting scaler
Building model 0
MoleculeModel(
  (softplus): Softplus(beta=1.0, threshold=20.0)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (seq_embedder): Embedding(21, 36, padding_idx=20)
  (rotary_embedder): RotaryEmbedding()
  (multihead_attn): MultiheadAttention(
    (out_proj): NonDynamicallyQuantizableLinear(in_features=36, out_features=36, bias=True)
  )
  (attentive_pooler): AttentivePooling(
    (linear1): Linear(in_features=36, out_features=36, bias=True)
    (tanh): Tanh()
    (linear2): Linear(in_features=36, out_features=1, bias=True)
    (softmax): Softmax(dim=1)
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=336, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 373,759
Moving model to cuda
Creating protein model
  0%|                                                                                     | 0/30 [00:00<?, ?it/s]Epoch 0

  0%|                                                                                    | 0/420 [00:00<?, ?it/s][A
  0%|▏                                                                           | 1/420 [00:04<30:16,  4.33s/it][A
  1%|▌                                                                           | 3/420 [00:04<08:07,  1.17s/it][A
  1%|█                                                                           | 6/420 [00:04<03:16,  2.11it/s][A
  2%|█▋                                                                          | 9/420 [00:04<01:56,  3.52it/s][ALoss = 1.3194e+00, PNorm = 36.4619, GNorm = 2.4484, lr_0 = 1.1181e-04

  3%|█▉                                                                         | 11/420 [00:04<01:27,  4.67it/s][A
  4%|██▊                                                                        | 16/420 [00:04<00:45,  8.81it/s][A
  5%|███▍                                                                       | 19/420 [00:05<00:41,  9.70it/s][ALoss = 1.3468e+00, PNorm = 36.4624, GNorm = 0.6720, lr_0 = 1.2255e-04

  5%|███▉                                                                       | 22/420 [00:05<00:32, 12.17it/s][A
  6%|████▍                                                                      | 25/420 [00:05<00:41,  9.41it/s][A
  7%|█████▏                                                                     | 29/420 [00:05<00:30, 12.65it/s][ALoss = 1.3986e+00, PNorm = 36.4627, GNorm = 1.9625, lr_0 = 1.3329e-04

  8%|█████▉                                                                     | 33/420 [00:06<00:29, 13.17it/s][A
  9%|██████▍                                                                    | 36/420 [00:06<00:25, 15.33it/s][ALoss = 1.3558e+00, PNorm = 36.4629, GNorm = 0.9308, lr_0 = 1.4403e-04

 10%|███████▏                                                                   | 40/420 [00:06<00:22, 17.25it/s][A
 10%|███████▋                                                                   | 43/420 [00:06<00:23, 16.04it/s][A
 11%|████████▍                                                                  | 47/420 [00:06<00:19, 19.38it/s][ALoss = 1.4621e+00, PNorm = 36.4641, GNorm = 2.8445, lr_0 = 1.5477e-04

 12%|████████▉                                                                  | 50/420 [00:07<00:21, 17.38it/s][A
 13%|█████████▋                                                                 | 54/420 [00:07<00:17, 20.89it/s][A
 14%|██████████▏                                                                | 57/420 [00:07<00:21, 16.67it/s][ALoss = 1.4504e+00, PNorm = 36.4659, GNorm = 0.5914, lr_0 = 1.6551e-04

 14%|██████████▋                                                                | 60/420 [00:07<00:19, 18.51it/s][A
 15%|███████████▍                                                               | 64/420 [00:08<00:28, 12.32it/s][A
 16%|███████████▊                                                               | 66/420 [00:08<00:30, 11.50it/s][ALoss = 1.3527e+00, PNorm = 36.4675, GNorm = 0.8850, lr_0 = 1.7625e-04

 17%|████████████▌                                                              | 70/420 [00:08<00:23, 14.96it/s][A
 17%|█████████████                                                              | 73/420 [00:08<00:23, 14.83it/s][A
 18%|█████████████▍                                                             | 75/420 [00:08<00:25, 13.76it/s][A
 19%|██████████████                                                             | 79/420 [00:08<00:19, 17.88it/s][ALoss = 1.3265e+00, PNorm = 36.4695, GNorm = 1.4888, lr_0 = 1.8699e-04

 20%|██████████████▋                                                            | 82/420 [00:09<00:21, 16.08it/s][A
 20%|███████████████▎                                                           | 86/420 [00:09<00:17, 19.18it/s][A
 21%|███████████████▉                                                           | 89/420 [00:09<00:20, 15.97it/s][ALoss = 1.4491e+00, PNorm = 36.4728, GNorm = 2.1051, lr_0 = 1.9773e-04

 22%|████████████████▎                                                          | 91/420 [00:09<00:19, 16.49it/s][A
 23%|█████████████████▏                                                         | 96/420 [00:09<00:14, 22.03it/s][A
 24%|█████████████████▋                                                         | 99/420 [00:10<00:17, 18.26it/s][ALoss = 1.3338e+00, PNorm = 36.4740, GNorm = 0.8322, lr_0 = 2.0847e-04

 25%|██████████████████▏                                                       | 103/420 [00:10<00:14, 21.58it/s][A
 25%|██████████████████▋                                                       | 106/420 [00:10<00:19, 16.09it/s][ALoss = 1.4713e+00, PNorm = 36.4758, GNorm = 1.5077, lr_0 = 2.1921e-04

 26%|███████████████████▍                                                      | 110/420 [00:10<00:16, 18.28it/s][A
 27%|███████████████████▉                                                      | 113/420 [00:10<00:15, 19.50it/s][A
 28%|████████████████████▍                                                     | 116/420 [00:10<00:14, 20.82it/s][ALoss = 1.3857e+00, PNorm = 36.4778, GNorm = 0.7649, lr_0 = 2.2995e-04

 29%|█████████████████████▎                                                    | 121/420 [00:11<00:17, 16.87it/s][A
 30%|█████████████████████▊                                                    | 124/420 [00:11<00:17, 17.28it/s][A
 30%|██████████████████████▏                                                   | 126/420 [00:11<00:17, 16.50it/s][A
 30%|██████████████████████▌                                                   | 128/420 [00:11<00:17, 16.95it/s][ALoss = 1.4559e+00, PNorm = 36.4802, GNorm = 1.8139, lr_0 = 2.4069e-04

 31%|██████████████████████▉                                                   | 130/420 [00:11<00:17, 16.27it/s][A
 32%|███████████████████████▌                                                  | 134/420 [00:11<00:14, 20.37it/s][A
 33%|████████████████████████▏                                                 | 137/420 [00:12<00:18, 15.41it/s][ALoss = 1.4052e+00, PNorm = 36.4839, GNorm = 1.2001, lr_0 = 2.5143e-04

 33%|████████████████████████▋                                                 | 140/420 [00:12<00:16, 17.28it/s][A
 35%|█████████████████████████▌                                                | 145/420 [00:12<00:15, 17.80it/s][A
 35%|██████████████████████████                                                | 148/420 [00:12<00:14, 19.12it/s][ALoss = 1.3877e+00, PNorm = 36.4866, GNorm = 2.5718, lr_0 = 2.6217e-04

 36%|██████████████████████████▌                                               | 151/420 [00:12<00:13, 19.42it/s][A
 37%|███████████████████████████▏                                              | 154/420 [00:13<00:21, 12.24it/s][A
 37%|███████████████████████████▍                                              | 156/420 [00:13<00:21, 12.25it/s][A
 38%|███████████████████████████▊                                              | 158/420 [00:13<00:19, 13.29it/s][ALoss = 1.4500e+00, PNorm = 36.4914, GNorm = 2.7724, lr_0 = 2.7291e-04

 38%|████████████████████████████▎                                             | 161/420 [00:13<00:20, 12.61it/s][A
 39%|█████████████████████████████                                             | 165/420 [00:14<00:14, 17.12it/s][A
 40%|█████████████████████████████▊                                            | 169/420 [00:14<00:15, 16.41it/s][ALoss = 1.3767e+00, PNorm = 36.4945, GNorm = 1.3400, lr_0 = 2.8365e-04

 41%|██████████████████████████████▎                                           | 172/420 [00:14<00:13, 18.09it/s][A
 42%|███████████████████████████████                                           | 176/420 [00:14<00:11, 22.06it/s][A
 43%|███████████████████████████████▌                                          | 179/420 [00:14<00:12, 18.85it/s][ALoss = 1.3953e+00, PNorm = 36.4970, GNorm = 0.8815, lr_0 = 2.9439e-04

 43%|████████████████████████████████                                          | 182/420 [00:14<00:12, 18.46it/s][A
 44%|████████████████████████████████▌                                         | 185/420 [00:15<00:14, 16.30it/s][A
 45%|█████████████████████████████████▎                                        | 189/420 [00:15<00:11, 19.96it/s][ALoss = 1.3636e+00, PNorm = 36.5030, GNorm = 3.4103, lr_0 = 3.0513e-04

 46%|██████████████████████████████████                                        | 193/420 [00:15<00:14, 15.16it/s][A
 46%|██████████████████████████████████▎                                       | 195/420 [00:15<00:15, 14.21it/s][A
 47%|███████████████████████████████████                                       | 199/420 [00:15<00:12, 17.98it/s][ALoss = 1.3722e+00, PNorm = 36.5072, GNorm = 1.1579, lr_0 = 3.1587e-04

 48%|███████████████████████████████████▌                                      | 202/420 [00:16<00:12, 17.57it/s][A
 49%|████████████████████████████████████▎                                     | 206/420 [00:16<00:10, 21.32it/s][A
 50%|████████████████████████████████████▊                                     | 209/420 [00:16<00:11, 18.24it/s][ALoss = 1.2928e+00, PNorm = 36.5127, GNorm = 1.2846, lr_0 = 3.2661e-04

 50%|█████████████████████████████████████▎                                    | 212/420 [00:16<00:10, 19.46it/s][A
 51%|██████████████████████████████████████                                    | 216/420 [00:16<00:09, 22.60it/s][A
 52%|██████████████████████████████████████▌                                   | 219/420 [00:16<00:10, 19.72it/s][ALoss = 1.4313e+00, PNorm = 36.5192, GNorm = 2.0460, lr_0 = 3.3735e-04

 53%|███████████████████████████████████████                                   | 222/420 [00:17<00:09, 20.18it/s][A
 54%|███████████████████████████████████████▋                                  | 225/420 [00:17<00:11, 17.53it/s][A
 55%|████████████████████████████████████████▎                                 | 229/420 [00:17<00:09, 20.48it/s][ALoss = 1.3545e+00, PNorm = 36.5255, GNorm = 0.9633, lr_0 = 3.4809e-04

 55%|████████████████████████████████████████▉                                 | 232/420 [00:17<00:09, 20.57it/s][A
 56%|█████████████████████████████████████████▍                                | 235/420 [00:17<00:10, 18.41it/s][A
 57%|██████████████████████████████████████████                                | 239/420 [00:17<00:08, 22.11it/s][ALoss = 1.4261e+00, PNorm = 36.5311, GNorm = 2.0351, lr_0 = 3.5883e-04

 58%|██████████████████████████████████████████▋                               | 242/420 [00:18<00:12, 14.06it/s][A
 59%|███████████████████████████████████████████▎                              | 246/420 [00:18<00:09, 17.86it/s][A
 59%|███████████████████████████████████████████▊                              | 249/420 [00:18<00:13, 12.57it/s][ALoss = 1.3663e+00, PNorm = 36.5398, GNorm = 1.5917, lr_0 = 3.6957e-04

 60%|████████████████████████████████████████████▌                             | 253/420 [00:19<00:10, 15.94it/s][A
 61%|█████████████████████████████████████████████                             | 256/420 [00:19<00:09, 17.83it/s][A
 62%|█████████████████████████████████████████████▋                            | 259/420 [00:19<00:12, 12.92it/s][ALoss = 1.3888e+00, PNorm = 36.5444, GNorm = 0.5981, lr_0 = 3.8031e-04

 62%|██████████████████████████████████████████████▏                           | 262/420 [00:19<00:10, 15.39it/s][A
 63%|██████████████████████████████████████████████▋                           | 265/420 [00:19<00:10, 15.12it/s][A
 64%|███████████████████████████████████████████████▏                          | 268/420 [00:19<00:08, 17.62it/s][ALoss = 1.4110e+00, PNorm = 36.5496, GNorm = 1.3367, lr_0 = 3.9105e-04

 65%|███████████████████████████████████████████████▉                          | 272/420 [00:20<00:07, 18.78it/s][A
 65%|████████████████████████████████████████████████▍                         | 275/420 [00:20<00:08, 17.01it/s][A
 66%|████████████████████████████████████████████████▊                         | 277/420 [00:20<00:08, 16.05it/s][ALoss = 1.4102e+00, PNorm = 36.5554, GNorm = 0.3743, lr_0 = 4.0179e-04

 67%|█████████████████████████████████████████████████▌                        | 281/420 [00:20<00:10, 13.64it/s][A
 68%|██████████████████████████████████████████████████                        | 284/420 [00:21<00:11, 11.93it/s][A
 69%|██████████████████████████████████████████████████▉                       | 289/420 [00:21<00:09, 14.30it/s][ALoss = 1.3892e+00, PNorm = 36.5619, GNorm = 0.5441, lr_0 = 4.1253e-04

 70%|███████████████████████████████████████████████████▍                      | 292/420 [00:21<00:08, 14.65it/s][A
 70%|████████████████████████████████████████████████████▏                     | 296/420 [00:21<00:07, 17.47it/s][A
 71%|████████████████████████████████████████████████████▌                     | 298/420 [00:21<00:08, 14.99it/s][ALoss = 1.3228e+00, PNorm = 36.5680, GNorm = 0.5533, lr_0 = 4.2327e-04

 71%|████████████████████████████████████████████████████▊                     | 300/420 [00:22<00:07, 15.68it/s][A
 72%|█████████████████████████████████████████████████████▍                    | 303/420 [00:22<00:06, 18.38it/s][A
 73%|█████████████████████████████████████████████████████▉                    | 306/420 [00:22<00:07, 14.33it/s][A
 73%|██████████████████████████████████████████████████████▎                   | 308/420 [00:22<00:07, 14.04it/s][ALoss = 1.3243e+00, PNorm = 36.5779, GNorm = 2.1615, lr_0 = 4.3401e-04

                                                                                                                 [A  0%|                                                                                     | 0/30 [00:25<?, ?it/s]
Traceback (most recent call last):
  File "/home/ubuntu/mychemprop/CatPred/train.py", line 4, in <module>
    catpred_train()
  File "/home/ubuntu/mychemprop/CatPred/catpred/train/cross_validate.py", line 210, in catpred_train
    cross_validate(args=TrainArgs().parse_args(), train_func=run_training)
  File "/home/ubuntu/mychemprop/CatPred/catpred/utils.py", line 619, in wrap
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/mychemprop/CatPred/catpred/train/cross_validate.py", line 121, in cross_validate
    model_scores = train_func(args, data, logger)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/mychemprop/CatPred/catpred/train/run_training.py", line 288, in run_training
    n_iter = train(
             ^^^^^^
  File "/home/ubuntu/mychemprop/CatPred/catpred/train/train.py", line 219, in train
    loss.backward()
  File "/home/ubuntu/miniconda3/envs/catpred/lib/python3.12/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/ubuntu/miniconda3/envs/catpred/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/ubuntu/miniconda3/envs/catpred/lib/python3.12/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 9.86 GiB. GPU 0 has a total capacity of 39.38 GiB of which 8.99 GiB is free. Including non-PyTorch memory, this process has 30.38 GiB memory in use. Of the allocated memory 29.69 GiB is allocated by PyTorch, and 201.10 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
